1. What are the details of all cars purchased in the year 2022?
select c.*
from cars c
join sales s using(car_id)
where year(s.purchase_date) = 2022

2. What is the total number of cars sold by each salesperson?
select sm.salesman_id, sm.name, count(s.sale_id) as Totalsales
from salespersons sm
join sales s using (salesman_id)
group by sm.salesman_id

3. What is the total revenue generated by each salesperson?
select sm.salesman_id, sm.name, sum(c.cost_$) as Totalsales
from salespersons sm
join sales s using (salesman_id)
join cars c using(car_id)
group by sm.salesman_id

4. What are the details of the cars sold by each salesperson?
select  sp.salesman_id, sp.name,s.sale_id, c.*
from salespersons sp 
join sales s using(salesman_id)
join cars c using(car_id)
order by sp.salesman_id

5. What is the total revenue generated by each car type?
select c.type, sum(c.cost_$) as revenue_generated
from cars c
join sales s using (car_id)
group by c.type

6. What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?
select sp.name, s.purchase_date, c.*
from cars c
join sales s using (car_id)
join salespersons sp using (salesman_id)
where year(s.purchase_date) = 2021 
and sp.name = "Emily Wong"

7. What is the total revenue generated by the sales of hatchback cars?
select sum(c.cost_$) as Hatchback_Revenue
from sales s
join cars c using (car_id)
where c.style = "Hatchback"

8. What is the total revenue generated by the sales of SUV cars in the year 2022?
select sum(c.cost_$) as SUV_Revenue_2022
from cars c
join sales s using (car_id)
where c.style = "SUV" and year (s.purchase_date) = 2022

9. What is the name and city of the salesperson who sold the most number of cars in the year 2023?
with cte as (select salesman_id,count(sale_id) as cnt
from sales 
where year(purchase_date) = 2023
group by salesman_id)
select sp.name, sp.city 
from salespersons sp
join cte c using (salesman_id)
where c.cnt = (select max(cnt) from cte)

10. What is the name and age of the salesperson who generated the highest revenue in the year 2022?
with cte as 
(select s.salesman_id, sum(c.cost_$) as revenue
from sales s
join cars c using (car_id)
where year(s.purchase_date) = 2022
group by s.salesman_id)
select sp.name, sp.age , c.revenue
from salespersons sp
join cte c using (salesman_id)
where c.revenue = (select max(revenue) from cte)
