# 1.What are the names of all the countries in the country table?
select country_name 
from country
-------------------------------------------------------------------------------------------------
#2. What is the total number of customers in the customers table?
select count(customer_id) as "total number of customers"
from customers
-------------------------------------------------------------------------------------------------
#3. What is the average age of customers who can receive marketing emails (can_email is set to 'yes')?
select avg(age) as AvgAge
from customers 
where can_email = 'yes'
-------------------------------------------------------------------------------------------------
#4. How many orders were made by customers aged 30 or older?
select count(o.order_id) as NumberOfOrders
from orders o join customers c using (customer_id)
where c.age >=30
-------------------------------------------------------------------------------------------------
#5. What is the total revenue generated by each product category?
select p.category, sum(p.price) as ReveuneGenerated
from products p
join baskets b using (product_id)
join orders o using (order_id)
group by p.category
-------------------------------------------------------------------------------------------------
#6. What is the average price of products in the 'food' category?
select avg(price) as AvgPrice
from products p
where category = 'food'
-------------------------------------------------------------------------------------------------
#7. How many orders were made in each sales channel (sales_channel column) in the orders table?
select sales_channel, count(order_id) NumOrders
from orders
group by sales_channel
-------------------------------------------------------------------------------------------------
#8. What is the date of the latest order made by a customer who can receive marketing emails?
select max(o.date_shop) LatestDate
from orders o 
join customers c using (customer_id)
where c.can_email = 'yes'
-------------------------------------------------------------------------------------------------
#9. What is the name of the country with the highest number of orders?
select c.country_name, count(o.order_id) as ordercount
from orders o 
join country c using (country_id)
group by c.country_name
having count(order_id)=
(select max(cnt)
from (select country_id, count(order_id) cnt
from orders
group by country_id) maxcnt
)
-------------------------------------------------------------------------------------------------
#10. What is the average age of customers who made orders in the 'vitamins' product category?
select round(avg(c.age),0) as AverageAge
from customers c
join orders o using (customer_id)
join baskets b using (order_id)
join products p using (product_id)
where p.category = 'vitamins'
